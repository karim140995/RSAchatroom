<!DOCTYPE html>
<html>
    <head>
        <title>Secure Chat Lobby</title>

	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
	<style>
		body {
		  color : green;
	          background-color : black;
		}
		h1{
		   width : 500px;
		   margin: 0 auto;
		   margin-bottom : 50px;
		}
		.auth{
		   margin : auto;
		   width : 700px;		
		}
	</style>
    </head>
    <body class="matrix">
	<div>
		<h1>Welcome to Secure Chat</h1>
		<div id ="main" class="row">
			<div class="auth">	
			<form id="f" name ="f" action="#" onsubmit = "register(); return false; " >
				 <div class="form-group row">
				    <div class="col-sm-12">	
				    <label for="csr" class="col-sm-2 col-form-label">Certificate Request(.pem):</label>
				      <textarea rows="5" required name="csr" class="form-control-plaintext" id="csr" value="Provide a CSR"></textarea>
				    </div>
				 </div>
				 <input type="submit" class="btn btn-success" value="Register"/>
				 <input type="button" class="btn btn-success" onclick="window.location.href = 'login.html';" value="Login"/>	
			</form>
			</div>
		</div>
	</div>
    </body>
<script src="https://code.jquery.com/jquery-3.4.1.js" integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU=" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-		wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

		
   <script>
 	var xhttp = new XMLHttpRequest(); 
	function register(){
            crt_pem= encodeURIComponent(document.getElementById("csr").value);
	    body = "csr="+crt_pem;  
	    $.post("http://127.0.0.1:5000/crt",body, function(result){
		alert("Your signed certificate is the following : \n" + result["crt"]);
	    })
	   .fail(function() {
	    	alert( "User already exists or bad certificate format" );
	    });
	}
   </script>
</html> 
